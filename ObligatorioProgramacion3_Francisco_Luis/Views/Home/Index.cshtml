@model ObligatorioProgramacion3_Francisco_Luis.Models.HomeIndexViewModel
@{
	ViewBag.Title = "Inicio - Voz del Este";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="bg-secondary bg-opacity-10 rounded p-3 d-flex flex-column align-items-center" style="width: 260px;">
	<h6 class="text-uppercase text-light mb-2">Clima Actual</h6>

	@if (Model.HasWeatherData)
	{
		<img src="@Model.CurrentWeatherIconUrl" alt="@Model.CurrentDescription" style="width: 60px;" class="mb-2" />
		<h5 class="fw-bold text-light mb-1">@Model.CurrentTemperature</h5>
		<small class="text-capitalize text-light">@Model.CurrentDescription</small>
	}
	else
	{
		<img src="/images/clima-icon.png" alt="Clima" style="width: 40px;" class="mb-2" />
		<h6 class="fw-bold text-light mb-1">
			@if (!string.IsNullOrEmpty(ViewBag.WeatherError as string))
			{
				<small>Sin datos</small>
			}
			else
			{
				<span>Cargando...</span>
			}
		</h6>
	}

	<hr class="bg-light w-100 my-2" />

	<h6 class="text-uppercase text-light mb-2">Semana</h6>

	@if (Model.HasForecastData)
	{
		<div class="w-100">
			@foreach (var item in Model.WeatherForecast)
			{
				if (item.Date.HasValue)
				{
					<div class="d-flex justify-content-between align-items-center py-1 border-bottom border-light">
						<small class="text-light fw-bold">
							@item.Date.Value.ToString("ddd", new System.Globalization.CultureInfo("es-ES"))
						</small>
						<img src="@($"https://openweathermap.org/img/wn/{item.Icon}@2x.png")" alt="@item.Description" style="width: 30px;" />
						<small class="text-light">
							@($"{(item.TempMin.HasValue ? item.TempMin.Value.ToString("0") : "-")}° / {(item.TempMax.HasValue ? item.TempMax.Value.ToString("0") : "-")}°C")
						</small>
					</div>
				}
			}
		</div>
	}
	else
	{
		<small class="text-light">No hay pronóstico disponible.</small>
	}
</div>


<div class="container-fluid bg-dark text-light min-vh-100 py-4" style="font-family: sans-serif; color: #E4D4B3; padding-top: 180px;">

	<!-- Bloque Audio -->
	<div class="row mt-4">
		<div class="col text-center">
			<h3 class="fw-bold mb-3">DALE PLAY QUE ESTAMOS EN VIVO</h3>
			<audio id="radio-player" controls style="width: 50%; max-width: 400px;">
				<source src="https://metropolis-web-1.nty.uy" type="audio/mpeg" />
				Tu navegador no soporta audio.
			</audio>
		</div>
	</div>

	<!-- Programas actuales y siguientes -->
	<div class="row mt-5">
		<div class="col-md-6">
			<h4 class="fw-bold">Programa Actual</h4>
			@if (Model.CurrentProgram != null)
			{
				<div class="card bg-secondary bg-opacity-25 mb-4" style="color: #E4D4B3;">
					<img src="@Model.CurrentProgram.ImageURL" class="card-img-top" alt="@Model.CurrentProgram.ProgramName" style="height: 200px; object-fit: cover;" />
					<div class="card-body">
						<h5 class="card-title">@Model.CurrentProgram.ProgramName</h5>
						<p class="card-text">@Model.CurrentProgram.RadioDescription</p>
						<p class="card-text">
							<small>Horario: @(Model.CurrentProgram.Schedule.HasValue ? Model.CurrentProgram.Schedule.Value.ToString("HH:mm") : "Horario no disponible")</small>
						</p>
					</div>
				</div>
			}
			else
			{
				<p>No hay programa en vivo actualmente.</p>
			}
		</div>

		<div class="col-md-6">
			<h4 class="fw-bold">Próximo Programa</h4>
			@if (Model.NextProgram != null)
			{
				<div class="card bg-secondary bg-opacity-25 mb-4" style="color: #E4D4B3;">
					<img src="@Model.NextProgram.ImageURL" class="card-img-top" alt="@Model.NextProgram.ProgramName" style="height: 200px; object-fit: cover;" />
					<div class="card-body">
						<h5 class="card-title">@Model.NextProgram.ProgramName</h5>
						<p class="card-text">@Model.NextProgram.RadioDescription</p>
						<p class="card-text">
							<small>Horario: @(Model.NextProgram.Schedule.HasValue ? Model.NextProgram.Schedule.Value.ToString("HH:mm") : "Horario no disponible")</small>
						</p>
					</div>
				</div>
			}
			else
			{
				<p>No hay programa siguiente programado.</p>
			}
		</div>
	</div>

	<!-- Programación completa del día -->
	<div class="row px-3 mt-4">
		<div class="col-md-6">
			<h5 class="fw-bold text-uppercase">Programación del Día</h5>
			<ul class="list-group list-group-flush" style="color: #E4D4B3;">
				@if (Model.ProgramsList != null && Model.ProgramsList.Any())
				{
					foreach (var program in Model.ProgramsList)
					{
						<li class="list-group-item bg-transparent d-flex justify-content-between align-items-center" style="border: none; padding-left: 0;">
							<span>@program.ProgramName</span>
							<span>@(program.Schedule.HasValue ? program.Schedule.Value.ToString("HH:mm") : "Horario no disponible")</span>
						</li>
					}
				}
				else
				{
					<li>No hay programas para hoy.</li>
				}
			</ul>
		</div>

		<div class="auspiciantes-slider" style="max-width: 300px; margin: auto; text-align: center;">
			<p>Nuestros auspiciantes.</p>
			@if (Model.AuspiciantesLogos != null && Model.AuspiciantesLogos.Any())
			{
				<img id="auspiciante-img" src="@Model.AuspiciantesLogos[0]" alt="Logo Auspiciante" style="max-height: 100px; object-fit: contain; width: 100%;" />
			}
			else
			{
				<p>No hay logos para mostrar.</p>
			}
		</div>

		@section scripts {
			<script>
        (function(){
            var logos = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.AuspiciantesLogos));
            var index = 0;
            var img = document.getElementById('auspiciante-img');
            if (logos.length > 1 && img) {
                setInterval(function() {
                    index = (index + 1) % logos.length;
                    img.src = logos[index];
                }, 3000); 
            }
        })();
			</script>
		}

	</div>

</div>
